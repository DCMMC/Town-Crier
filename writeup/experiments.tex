\section{Experiments}


\subsection{Total execution time}

% justify why a laptop is used 
We evaluated the performance of \tc on a Dell Inspiron 13-7359 laptop equipped
with an Intel i7-6500U CPU and 8.00GB memory.  This model is chosen just
because it is one of the few SGX-enabled systems available on the market as the
writing of this paper. Although the hosting platform is just moderately preferment, we
show that on a single host, the current implementation is able to handle 
transactions generated by Ethereum blockchain in real time. 


We measured the running time of handling a request. The measurement begins
at the point when a request is discovered and ends at the point when the
response is sent to delivery. 
Propagation latency of the Ethereum network
is not measured since it is out of the control of \tc. 
Table \ref{tab:eval_profiling} summarizes the execution time 
break down of handling a request.

\begin{table*}[ht]
\centering
\begin{tabular}{lrr|rr|rr}
\toprule
& \multicolumn{2}{c|}{\sf CashSettledPut} & 
  \multicolumn{2}{c|}{\sf FlightIns} &
  \multicolumn{2}{c}{\sf Third one} \\ 
  & time(ms) & percentage & time(ms) & percentage & time(ms) & percentage\\
\midrule
Switch to \encname  & 0.41    & 0.21\%   & 0.44      & 0.08\%    & - & -\\
Web Scraper         & 181.03  & 94.12\%  & 512.32    & 98.02\%   & - & -\\
Sign                & 10.63   & 5.53\%   & 9.64      & 1.85\%    & - & -\\
Serialization       & 0.28    & 0.14\%   & 0.25      & 0.05\%    & - & -\\
\midrule
Total               & 192.35  & 100.00\%    & 522.65    & 100.00\% \\
\bottomrule
\end{tabular}
\caption{\fan{Complete the table} 
Running time of handling a request}
\label{tab:eval_profiling}
\end{table*}

Web scrapers contribute the most to the
total execution time. This portion of running time
is application-specific and mainly depends on the
amount of fetched data.

%Suggested by Table \ref{tab:eval_profiling}, fetching web pages 
%over HTTPS is the most expensive operation. This is because: 1)
%fetching data triggers
%a lot of context switches 
%and data transferring between the enclave and untrusted application;
%2) networking latency is reflected 

\subsection{Clock precision}

Recall that the absolute time of the \encname is verified
by including a signed time stamp in the attestation and letting 
clients check it it in real time. Therefore the latency
of attestation generation plus a round-trip time
define the precision of the absolute clock. 
We evaluated the cycles consumed in generating an attestation and
signing a Unix time stamp.


\begin{table}[ht]
\centering
\begin{tabular}{lr}
\toprule
  & time(ms) \\
\midrule
Report Generation & $203.04$ \\
Quote Generation & $233.49$ \\
Signing the time stamp & $27.48$ \\
\bottomrule
\end{tabular}
\caption{Running time of generating \att}
\label{tab:eval_att}
\end{table}

Table \ref{tab:eval_att} summarizes the running time break down of generating an
attestation along with a signed time stamp.  Note that two steps are involved in
generating \att: first a report is produced within the \encname; then, an
attestation, as known as a quote, is produced by QE based on the report passed
to it. Note that \att only need to be generated once throughout the lifetime of the
enclave.


\subsection{Gas costs}

At the writing of this paper, 10 ether is worth approximately \$2, and 1 gas costs $5 \cdot 10^{-8}$ ether.
This means that 1 million gas costs approximately \$0.01.
Here we give values for our implementation for the gas variables we defined in Section \ethan{ref gas constant definitions} (all units are in gas).
\begin{center}
  \begin{tabular}{lr}
    \hline
    $\constgasmin$ & \num[group-separator={,}]{35000} \\
    \hline
    $\constgasmax$ & \num[group-separator={,}]{3100000} \\
    \hline
%    $\constgascancel$ & \num[group-separator={,}]{24500} \\
%    \hline
%    $\gascancel$ & \num[group-separator={,}]{38000} \\
%    \hline
%    $\gasrequest$ & \num[group-separator={,}]{120000} + \num[group-separator={,}]{2700}/32 bytes \\
%    \hline
  \end{tabular}
\end{center}
Note that $\constgasmax$ is currently limited to the above value because Ethereum will refuse to accept transactions with {\tt GASLIMIT} above 3.1 million.

%The cost of executing the {\bf Cancel} entry point (i.e. the value an honest user will assign to $\gascancel$) is about \num[group-separator={,}]{38000} gas.

The cost for executing {\bf Request} is approximately \num[group-separator={,}]{120000} gas plus \num[group-separator={,}]{2700} gas for every 32 bytes of request parameters.
The high expense is due to the cost of on-blockchain storage
while the scaling is because the caller must pay gas for including more bytes in a transaction.


