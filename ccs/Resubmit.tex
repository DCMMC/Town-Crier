\documentclass{sig-alternate}

\usepackage{acmcopyright}
\usepackage{epsfig,endnotes}
\let\proof\relax
\let\endproof\relax
\usepackage{amsthm}
\usepackage{tabularx}
\usepackage{boxedminipage}
\usepackage[override]{cmtt}
\usepackage[utf8]{inputenc}
\usepackage{color,xcolor}
\usepackage{graphicx}
\usepackage{xspace}
\usepackage{latexsym}
\usepackage[sort]{cite}
\usepackage{url,hyperref}
%\usepackage{setspace}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{pgfplots}
\pgfplotsset{compat=1.9}
\usepackage{textcomp}

% suppress left margin for items
\usepackage{enumitem}
\setlist[itemize]{leftmargin=*}
\setlist[enumerate]{leftmargin=*}

\usepackage{tikz}
\usetikzlibrary{arrows,calc,fit,matrix,positioning,shapes.misc,shapes}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\tikzset{%
  entity/.style={rectangle,draw=black,align=center},
  trusted/.style={fill=green!30},
  communication/.style={blue},
  comm-link/.style={communication,ultra thick,text=black},
  bg-box/.style={rectangle,rounded corners,inner sep=0.6em},
  blockchain-color/.style={fill=blue!15},
  tc-server-color/.style={fill=black!18},
  every path/.style={>=stealth},
}

\usepackage{listings}
\lstdefinestyle{Solidity}
{
  language=C++,
  basicstyle={\small\ttfamily},
  morekeywords={function,contract,constant},
  emph={address,uint8,uint32,uint,uint64,bytes4,bytes32},
  keywordstyle={\color{darkgreen}},
  emphstyle={\color{darkblue}},
  commentstyle={\color{gray}\slshape},
  frame=single,
}

%\DeclareMathAlphabet{\mathcal}{OMS}{cmsy}{m}{n}

\newcommand{\kyle}[1]{\textcolor{blue}{[\textsf{Kyle:  #1}]}}
\newcommand{\fan}[1]{\textcolor{red}{[\small \bf {Fan:  #1}]}}
\definecolor{darkgreen}{rgb}{0,0.6,0}
\newcommand{\ari}[1]{\textcolor{darkgreen}{[\textsf{Ari:  #1}]}}
\newcommand{\ethan}[1]{\textcolor{cyan}{[\small \textsf{Ethan: #1}]}}
\newcommand{\elaine}[1]{\textcolor{magenta}{[\textsf{elaine:  #1}]}}

% Complex \xxx for making notes of things to do.  Use \xxx{...} for general
% notes, and \xxx[who]{...} if you want to blame someone in particular.
% Puts text in brackets and in bold font, and normally adds a marginpar
% with the text ``xxx'' so that it is easy to find.  On the other hand, if
% the comment is in a minipage, figure, or caption, the xxx goes in the text,
% because marginpars are not possible in these situations.
{\makeatletter
 \gdef\xxxmark{%
   \expandafter\ifx\csname @mpargs\endcsname\relax % in minipage?
     \expandafter\ifx\csname @captype\endcsname\relax % in figure/caption?
       \marginpar{\textcolor{red}{xxx~}}% not in a caption or minipage, can use marginpar
     \else
       \textcolor{red}{xxx~}% notice trailing space
     \fi
   \else
     \textcolor{red}{xxx~}% notice trailing space
   \fi}
 \gdef\xxx{\@ifnextchar[\xxx@lab\xxx@nolab}
 \long\gdef\xxx@lab[#1]#2{{\bf \small [\xxxmark \textcolor{red}{#2} ---{\sc #1}]}\xspace}
 \long\gdef\xxx@nolab#1{{\bf \small [\xxxmark \textcolor{red}{#1}]}\xspace}
}

\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}

\newtheorem*{rethm}{\retitle}
\newenvironment{retheorem}[1]{%
  \def \retitle{Theorem \ref{#1}}%
  \begin{rethm}%
}{\end{rethm}}

\frenchspacing

%don't want date printed
\date{}

\title{Town Crier: \\ An Authenticated Data Feed for Smart Contracts}

% You need the command \numberofauthors to handle the 'placement
% and alignment' of the authors beneath the title.
%
% For aesthetic reasons, we recommend 'three authors at a time'
% i.e. three 'name/affiliation blocks' be placed beneath the title.
%
% NOTE: You are NOT restricted in how many 'rows' of
% "name/affiliations" may appear. We just ask that you restrict
% the number of 'columns' to three.
%
% Because of the available 'opening page real-estate'
% we ask you to refrain from putting more than six authors
% (two rows with three columns) beneath the article title.
% More than six makes the first-page appear very cluttered indeed.
%
% Use the \alignauthor commands to handle the names
% and affiliations for an 'aesthetic maximum' of six authors.
% Add names, affiliations, addresses for
% the seventh etc. author(s) as the argument for the
% \additionalauthors command.
% These 'additional authors' will be output/set for you
% without further effort on your part as the last section in
% the body of your article BEFORE References or any Appendices.

%\numberofauthors{5} %  in this sample file, there are a *total*
%% of EIGHT authors. SIX appear on the 'first-page' (for formatting
%% reasons) and the remaining two appear in the \additionalauthors section.
%%
%\author{
%% You can go ahead and credit any number of authors here,
%% e.g. one 'row of three' or two rows (consisting of one row of three
%% and a second row of one, two or three).
%%
%% The command \alignauthor (no curly braces needed) should
%% precede each author name, affiliation/snail-mail address and
%% e-mail address. Additionally, tag each line of
%% affiliation/address with \affaddr, and tag the
%% e-mail address with \email.
%%
%% 1st. author
%\alignauthor Fan Zhang \\
%  \affaddr{Cornell University}\\
%  \affaddr{IC3${}^\dagger$}\\
%  \email{fanz@cs.cornell.edu}
%% 2nd. author
%\alignauthor Ethan Cecchetti \\
%  \affaddr{Cornell University}\\
%  \affaddr{IC3${}^\dagger$}\\
%  \email{ethan@cs.cornell.edu}
%% 3rd. author
%\alignauthor Kyle Croman \\
%  \affaddr{Cornell University}\\
%  \affaddr{IC3${}^\dagger$}\\
%  \email{kcroman@cs.cornell.edu}
%\and  % use '\and' if you need 'another row' of author names
%% 4th. author
%\alignauthor Ari Juels \\
%  \affaddr{Cornell Tech, Jacobs Institute}\\
%  \affaddr{IC3${}^\dagger$}\\
%  \email{juels@cornell.edu}
%% 5th. author
%\alignauthor Elaine Shi \\
%  \affaddr{Cornell University}\\
%  \affaddr{IC3${}^\dagger$}\\
%  \email{rs2358@cornell.edu}
%\and
%\affaddr{${}^\dagger$Initiative for CryptoCurrencies and Contracts}
%}
% There's nothing stopping you putting the seventh, eighth, etc.
% author on the opening page (as the 'third row') but we ask,
% for aesthetic reasons that you place these 'additional authors'
% in the \additional authors block, viz.
%\additionalauthors{Additional authors: John Smith (The Th{\o}rv{\"a}ld Group,
%email: {\texttt{jsmith@affiliation.org}}) and Julius P.~Kumquat
%(The Kumquat Consortium, email: {\texttt{jpkumquat@consortium.net}}).}
%\date{30 July 1999}
% Just remember to make sure that the TOTAL number of authors
% is the number that will appear on the first page PLUS the
% number that will appear in the \additionalauthors section.


%**** COLORS *********
\definecolor{maroon}{RGB}{178, 34, 34}
%\definecolor{brown}{RGB}{139, 137, 137}
\definecolor{gold}{rgb}{0.85, 0.65, 0.13}
\definecolor{darkgreen}{rgb}{0,0.5,0}
\definecolor{darkblue}{rgb}{0, 0, 0.5}

\newcommand{\smaroon}[1]{\ensuremath{\textcolor{maroon}{\tt #1}\xspace}}
\newcommand{\sgold}[1]{\ensuremath{\textcolor{gold}{\tt #1}\xspace}}
\newcommand{\sbrown}[1]{\ensuremath{\textcolor{brown}{\tt #1}\xspace}}
\newcommand{\sblue}[1]{\ensuremath{\textcolor{darkblue}{\tt #1}\xspace}}

\newcommand{\sgray}[1]{{\color{gray} #1}}

%**** DEFINITIONS *********

\newcommand {\tcs} {Town Crier\xspace}
\newcommand {\tc} {TC\xspace}
\newcommand {\tcontract} {{TC Contract}\xspace}
\newcommand {\encname} {{Enclave}\xspace}
\newcommand {\medname} {{Relay}\xspace}
\newcommand {\Time} {{{\tt T}}}


\newcommand {\cont} {\ensuremath{{\cal C}}\xspace}
\newcommand {\wallet} {\ensuremath{{\cal W}}\xspace}
\newcommand {\reqcont} {\ensuremath{\cont_U}\xspace}
\newcommand {\tcont} {\ensuremath{\cont_{\it TC}}\xspace}
\newcommand {\tcadd} {\ensuremath{\wallet_{\it TC}}\xspace}
\newcommand {\sgxadd} {\ensuremath{\wallet_{\it SGX}}\xspace}
\newcommand{\pkTC}{\ensuremath{{\sf pk}_{\it TC}}\xspace}
\newcommand{\skTC}{\ensuremath{{\sf sk}_{\it TC}}\xspace}
\newcommand{\userwallet}{\ensuremath{\wallet_U}\xspace}
\newcommand{\specialwallet}{\ensuremath{\wallet^*}\xspace}

\newcommand {\dgreq} {{\sf req}\xspace}
\newcommand {\dgform} {{\sf params}\xspace}
\newcommand {\dgspec} {{\sf spec}\xspace}
\newcommand {\dgpay} {{\sf \$fee}\xspace}
\newcommand {\dg} {{\sf d}\xspace}
\newcommand {\dgret} {{\sf ans}\xspace}
\newcommand {\dgm} {{\sf data}\xspace}
\newcommand {\dgid} {{\sf id}\xspace}
\newcommand {\dgcallback} {{\sf callback}\xspace}

\newcommand {\att} {{\sf att}\xspace}

\newcommand{\fsgx}{\ensuremath{\mathcal{F}_{\textrm{sgx}}}\xspace}
\newcommand{\pk}{\ensuremath{{\sf pk}}}
\newcommand{\sk}{\ensuremath{{\sf sk}}}
\newcommand{\pkM}{\ensuremath{{\sf pk}_{\mathrm{sgx}}}}
\newcommand{\skM}{\ensuremath{{\sf sk}_{\mathrm{sgx}}}}
\newcommand{\pksgx}{\ensuremath{{\sf pk}_{\textrm{TC}}}\xspace}
\newcommand{\sksgx}{\ensuremath{{\sf sk}_{\textrm{TC}}}\xspace}
\newcommand{\pkurl}{\ensuremath{{\sf pk}_{\textrm{url}}}\xspace}
\newcommand{\relay}{\ensuremath{\mathcal{R}}\xspace}
\newcommand{\engine}{\ensuremath{\enclaveprog}\xspace}
\newcommand{\enclaveprog}{\ensuremath{{\sf prog}_{\textrm{encl}}}\xspace}
\newcommand{\prog}{\ensuremath{{\sf prog}}\xspace}
\newcommand{\sigatt}{\ensuremath{{\sigma_{\textrm{att}}}}\xspace}
\newcommand{\sigsgx}{\ensuremath{{\Sigma_{\textrm{sgx}}}}}
\newcommand{\weburl}{\ensuremath{{{\sf url}}}\xspace}
\newcommand{\clock}{\ensuremath{{{\sf clock}}}}
\newcommand{\algA}{\ensuremath{\mathcal{A}}}
\newcommand{\algB}{\ensuremath{\mathcal{B}}}

\newcommand{\initcall}{\texttt{init}\xspace}
\newcommand{\attcall}{\texttt{attest}\xspace}
\newcommand{\resumecall}{\texttt{resume}\xspace}

\newcommand{\gas}{\sbrown{\$g}\xspace}
\newcommand{\constgasmin}{\sblue{\$G_\text{min}}\xspace}
\newcommand{\constgasmax}{\sblue{\$G_\text{max}}\xspace}
\newcommand{\constgascancel}{\sblue{\$G_\emptyset}\xspace}
\newcommand{\gasdeliver}{\sbrown{\$g_\text{dvr}}\xspace}
\newcommand{\gasrequest}{\sbrown{\$g_\text{req}}\xspace}
\newcommand{\gascallback}{\sbrown{\$g_\text{clbk}}\xspace}
\newcommand{\gascancel}{\sbrown{\$g_\text{cncl}}\xspace}
\newcommand{\fee}{\smaroon{\$f}\xspace}
\newcommand{\constgasinvokecancel}{\sblue{\$G_\text{cncl}}\xspace}
\newcommand{\constgasrequest}{\sblue{\$G_\text{req}}\xspace}
\newcommand{\consthonestfee}{\sblue{\$F}\xspace}

\newcommand{\msgi}[1]{\ensuremath{\textbf{msg}.m_{#1}}}
\newcommand{\bal}[1]{\ensuremath{{\sf bal}({#1})}}

\newcommand{\tcb}{\ensuremath{\mathcal{T}}\xspace}
\newcommand{\tcboff}{\ensuremath{\tcb_{\textsf{Off}}}\xspace}
\newcommand{\tcbon}{\ensuremath{\tcb_{\textsf{On}}}\xspace}
\newcommand{\oauth}{\ensuremath{\mathcal{O}_{\textsf{Auth}}}\xspace}
\newcommand{\pkoff}{\ensuremath{\textsf{pk}_{\textsf{Off}}}\xspace}

\renewcommand{\paragraph}[1]{{\vspace{5pt}\noindent\textbf{#1}}}

%*****************************

\makeatletter
\def\@copyrightspace{\relax}
\makeatother

\begin{document}

\maketitle

\input{abstract}
\input{introduction}
\input{background}
\input{architecture}
\input{protocol_overview}
\input{challenges}
\input{protocol-new}
\input{analysis}
%\input{applications}
\input{experiments}

\input{related}
\input{future-work}
\input{conclusion}

\bibliographystyle{abbrv}

{\scriptsize
\bibliography{ethereum,sgx,bitcoin,elaine}
}


\pagebreak

\appendix 
%\input{clock}
\input{implementation}
\input{sgxmodel}
\input{analysis-proofs}
\input{applications-full}
%\input{advanced}
%\input{pseudocode}



%\theendnotes
\end{document}
